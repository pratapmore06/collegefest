{% extends 'events/base.html' %}

{% block content %}
<h2 class="text-5xl font-bold mb-3 text-yellow-500 ">{{ event.title }}</h2><br>
<p class="text-3xl font-bold mb-3 text-gray-400 ">{{ event.description }}</p><br>
<p class="text-2xl font-bold mb-3 text-gray-400 "><strong>Date:</strong> {{ event.date }}</p> <br>
<p class="text-2xl font-bold mb-3 text-gray-400 "><strong>Location:</strong> {{ event.location }}</p><br>

{% if user.is_authenticated %}
    {% if participated %}
        <p class="text-xl  text-green-900 md:text-2xl lg:text-3xl font-light mb-10 animate-fade-in-up animate-delay-50">You have already registered for this event.</p>
    {% else %}
        <form method="post" action="{% url 'participate_event' event.id %}">
            {% csrf_token %}
            <button type="submit" class="bg-red-500 text-gray-900 font-bold py-3 px-8 rounded-full text-lg hover:bg-yellow-500 transition duration-300 shadow-lg transform hover:scale-105">Participate</button>
        </form>
    {% endif %}
{% else %}
    <p><a href="{% url 'login' %}">Login</a> to participate in this event.</p>
    <script>
  const countdownEl = document.getElementById('countdown');
  const eventDate = new Date("{{ event.date|date:'Y-m-d' }}T00:00:00").getTime();

  function updateCountdown() {
    const now = new Date().getTime();
    const distance = eventDate - now;

    if (distance < 0) {
      countdownEl.innerHTML = "This event has passed.";
      clearInterval(interval);
      return;
    }

    const days = Math.floor(distance / (1000 * 60 * 60 * 24));
    const hours = Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
    const minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));
    const seconds = Math.floor((distance % (1000 * 60)) / 1000);

    countdownEl.innerHTML = `
      <strong>Event starts in:</strong> 
      ${days}d ${hours}h ${minutes}m ${seconds}s
    `;
  }

  updateCountdown();
  const interval = setInterval(updateCountdown, 1000);
</script>
{% endif %}
{% endblock %}